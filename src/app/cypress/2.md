fixtures > formInit.json
{
    "formName":"form - "
}
integration > cucumber-tests >createForm

-- createFormPage.js

  const URL = 'http://localhost:8080';
const COMPLETEDFORMBUTTON = '#app > nav > ul > li:nth-child(2) > a > div';
const CREATEFORMBUTTON = '#app > nav > div.cta-container > div > button'
const FORMNAMEFIELD = '#formName'
const SELECTFORMTYPE = '#app > main > section > div > section > div > div.content > div > div:nth-child(4) > label'
const FORMTYPE = '#formType'
const STARTCREATINGBUTTON = '#app > main > section > div > section > div > div.content > section > button'
const GETSTARTEDBUTTON = '#app > main > section > div > div > div > div > button'


class CreateFormPage {
    static visitHomePage() {
        cy.visit(URL);
        cy.get(COMPLETEDFORMBUTTON).click()
        cy.get(CREATEFORMBUTTON).click()
        
    }

    static fillInInitForm() {
        cy.fixture("formInit").then((forminit)=>{
            const formName = forminit.formName + Math.random().toString(36).substring(2, 15) + Math.random().toString(36).substring(2, 15);
            debugger
            cy.get(FORMNAMEFIELD).type(formName)
        });

        cy.get(SELECTFORMTYPE).click()
        cy.get(FORMTYPE).eq(0).select('Policy');
        cy.matchImageSnapshot();
        cy.get(STARTCREATINGBUTTON).click()
        cy.get(GETSTARTEDBUTTON).click()
    }

    static dragdropControl(){

    }
    static useBuilderForm() {

        cy.get('.toolbox> ul > li:nth-child(1) > div.handle').as('sourceItemtext')
        cy.get('.toolbox> ul > li:nth-child(2) > div.handle').as('sourceItemlist')
        cy.get('.toolbox> ul > li:nth-child(3) > div.handle').as('sourceItemsingle')
        cy.get('.builder ul.dragArea .dragArea ').as('targetItem')

        cy.get('@sourceItemtext')
            .trigger('pointerdown', { which: 1, button: 0 })
            .drag('@targetItem', 'center')

        cy.get('@sourceItemlist')
            .trigger('pointerdown', { which: 1, button: 0 })
            .drag('@targetItem', 'center')

        cy.get('@sourceItemsingle')
            .trigger('pointerdown', { which: 1, button: 0 })
            .drag('@targetItem', 'center')

        cy.get('.builder ul.dragArea .dragArea > div:nth-child(1) ').as('itemfirst')
        cy.get('.builder ul.dragArea .dragArea > div:nth-child(2) ').as('itemsecond')
        cy.get('.builder ul.dragArea .dragArea > div:nth-child(3) ').as('itemthird')


        cy.get('@itemsecond')
            .trigger('pointerdown', { which: 1, button: 0 })
            .drag('@itemthird', 'center')


        //edit control single selection
        cy.get('@itemfirst').find('button:nth-child(2)').click();

        cy.get('aside .content li:nth-child(3) > button').filter(':visible').click();
        cy.get('aside .content li:nth-child(3) > button').filter(':visible').click();
        cy.get('aside .content li:nth-child(3) > button').filter(':visible').click();
        cy.get('aside .content li:nth-child(3) > button').filter(':visible').click();

        cy.get('aside .content li:nth-child(1) input').clear().type('item1')
        cy.get('aside .content li:nth-child(2) input').clear().type('item2')
        cy.get('aside .content li:nth-child(3) input').clear().type('item3')
        cy.get('aside .content li:nth-child(4) input').clear().type('item4')
        cy.get('aside .content li:nth-child(5) input').clear().type('item5')

        cy.get('.builder>.content').matchImageSnapshot();

        cy.get('aside .content div:nth-child(4) > ul > li').should(($li) => {
            expect($li).to.have.length(5)
        })
        cy.get('aside .content li:nth-child(3)  li:nth-child(2)>button').click();
        cy.get('aside .content div:nth-child(4) > ul > li').should(($li) => {
            expect($li).to.have.length(4)
        })

        cy.get('.content ul>li.is-step:nth-child(1)  div:nth-child(2) > label').click()

        //end of edit control single selection

        //select text box control
        /// bug here -- override placeholder
        cy.get('@itemsecond').find('button:nth-child(2)').click();

        //#questionName
        cy.get('#questionName').clear().type('Question Name with Test')
        //#placeholder
        cy.get('#placeholder').clear().type('placeholder with Test')
        cy.get('aside .content div:nth-child(3) > label:nth-child(3)').click()
        //aside .content div:nth-child(3) > label:nth-child(3)
        cy.get('aside .content div:nth-child(4) > label:nth-child(3)').click()
        cy.get('aside .content div:nth-child(5) > label:nth-child(3)').click()

        //build up trigger list
        //cy.document().its('#app')

        cy.get('#trigger option').eq(2).invoke('val').then((val)=>{
            cy.get('#trigger').select(val)
          })

        cy.get('.toolbox>.actions>button:nth-child(2)').click()
    }

    static createSuccess() {
        cy.get('.nav-links>li:nth-child(3)').click()
    }
}

export default CreateFormPage

-- createFormStep.js

import { Given, When, Then } from 'cypress-cucumber-preprocessor/steps';
import CreateFormPage from './createFormPage';

Given('I can access page with create form button', () => {
	CreateFormPage.visitHomePage();
});

When('I can fill init form', () => {
	CreateFormPage.fillInInitForm();
});

When('I use builder form to dragdrop tools', () => {
	CreateFormPage.useBuilderForm();
});

Then('I can create new form successfully', () => {
	CreateFormPage.createSuccess();
});

-- integration > cucumber-tests > viewForm
----  viewFormPage.js


const URL = 'http://localhost:8080';

class ViewFormPage {
    static visitHomePage() {
        cy.visit(URL);
    }

    static selectFormFromList(formName) {
        cy.get('.has-policies').contains(formName).click()
    }

    static goThroughAllSteps() {
        cy.get('#app > main > section > div > div.is-step > div > div > button').click();
        //close associate click
        cy.get('#app > main > section > div > div.is-step > div > div:nth-child(2) > div > div:nth-child(2) > label > p').click();
        //should show close associate full name
      
        cy.get('#associate-name').click().focused().type('test 11', {force: true}).should('have.value', 'test 11');
        cy.get('#app > main > section > div > div.is-step > div > div.step-actions > button:nth-child(2)').click();

        cy.get('#app > main > section > div > div.is-step > div > div.input-container > section > div > label:nth-child(3)').click();
        cy.get('#app > main > section > div > div.is-step > div > div.step-actions > button:nth-child(2)').click();

        //fill in forms
        cy.get('#element-2').click().focused().type('name 11', {force: true}).should('have.value', 'name 11');
        cy.get('#element-3').click().focused().type('job 11', {force: true}).should('have.value', 'job 11');
        cy.get('#element-4').select('2')
        cy.get('#element-5').select('5')

        cy.get('#app > main > section > div > div.is-step > div > div.step-actions > button:nth-child(2)').click();


        const releventboxes = '#app > main > section > div > div.is-step > div > div.input-container > section > span > div';
        cy.get(releventboxes).should('have.length', 9);

        cy.get(releventboxes).each(($el) => {
         cy.wrap($el).click(); 
       })
       cy.get('#app > main > section > div > div.is-step > div > div.step-actions > button:nth-child(2)').click();

       cy.get('#element-7').type('test area 11')
       cy.get('#app > main > section > div > div.is-step > div > div.step-actions > button:nth-child(2)').click();
       cy.get('#app > main > section > div > div.is-step > div > div.input-container > section > div > label:nth-child(3)').click();
       
    }

    static clickViewSummary() {
        cy.get('#app > main > section > div > div.is-step > div > div.step-actions > button:nth-child(2)').click();
        cy.get('#app > main > section > div > div.is-step > div > div.step-actions > button.button.primary.is-large').click();
    }

    static completeForm() {
        

        cy.get('#vs1__combobox').click();
        cy.get('#vs1__option-0').click();
        cy.get('#modals-container > div > div.vm--modal > div > footer > section > button').click();
    }
}

export default ViewFormPage;


--viewFormSteps.js

import { Given, When, Then } from 'cypress-cucumber-preprocessor/steps';
import ViewFormPage from './viewFormPage'

Given('I accesss the home page', () => {
	ViewFormPage.visitHomePage();
});

When('I select {string} from list', (formName) => {
	ViewFormPage.selectFormFromList(formName);
});


When('I go through all the steps', () => {
	ViewFormPage.goThroughAllSteps();
});

When('I click the view summary', () => {
	ViewFormPage.clickViewSummary();
});

Then('I can complete the form', () => {
	ViewFormPage.completeForm();
});

createForm.feature
Feature: Create Form

    As an administrator
    I can create new Form for client

    Scenario: Create Form for Client
        Given I can access page with create form button
        When I can fill init form
        And I use builder form to dragdrop tools
        Then I can create new form successfully

viewForm.feature

Feature: View form content and fill in view form

    As a Form user
    I want to be able to complete the form view

    Scenario: Complete View Form
        Given I accesss the home page
        When I select "Annual Disclosure of Interest" from list
        And I go through all the steps
        And I click the view summary
        Then I can complete the form
        
plugins >>  index.js

const cucumber = require('cypress-cucumber-preprocessor').default;
const {
  addMatchImageSnapshotPlugin,
} = require('cypress-image-snapshot/plugin');
/**
 * @type {Cypress.PluginConfig}
 */
module.exports = (on, config) => {
  // `on` is used to hook into various events Cypress emits
  // `config` is the resolved Cypress config
  on('file:preprocessor', cucumber());
  addMatchImageSnapshotPlugin(on, config);
}


--cypress.json

{
    "chromeWebSecurity": false,
    "blacklistHosts": "*..incommunities.co.uk/",
    "env": {
        "no_proxy": "undefined,localhost"
    },
    "viewportWidth": 1400,
    "viewportHeight": 800,
    "video": true,
	"defaultCommandTimeout": 8000,
	"pageLoadTimeout": 10000,
    "waitForAnimations": true,
    "hosts": {
        "*.localhost": "127.0.0.1"
      }

    
}

--package.json
"dependencies": {
    "cross-env": "^7.0.2",
    "cypress": "^4.10.0",
    "cypress-cucumber-preprocessor": "^2.5.3",
    "cypress-image-snapshot": "^3.1.1",
    "lodash": "^4.17.17"
  },
  "cypress-cucumber-preprocessor": {
    "nonGlobalStepDefinitions": true
  }




